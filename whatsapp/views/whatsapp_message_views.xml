<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        
        <!-- WhatsApp Message Tree View -->
        <record id="whatsapp_message_tree" model="ir.ui.view">
            <field name="name">whatsapp.message.tree</field>
            <field name="model">whatsapp.message</field>
            <field name="arch" type="xml">
                <list string="WhatsApp Messages" decoration-info="direction == 'incoming'" decoration-success="direction == 'outgoing'">
                    <field name="timestamp"/>
                    <field name="direction"/>
                    <field name="from_name"/>
                    <field name="to_name"/>
                    <field name="message_type"/>
                    <field name="message"/>
                    <field name="status"/>
                    <field name="account_id"/>
                    <field name="contact_id"/>
                    <field name="group_id"/>
                </list>
            </field>
        </record>
        
        <!-- WhatsApp Message Form View -->
        <record id="whatsapp_message_form" model="ir.ui.view">
            <field name="name">whatsapp.message.form</field>
            <field name="model">whatsapp.message</field>
            <field name="arch" type="xml">
                <form string="WhatsApp Message">
                    <sheet>
                        <group>
                            <group>
                                <field name="account_id" readonly="1"/>
                                <field name="direction" readonly="1"/>
                                <field name="message_type" readonly="1"/>
                                <field name="timestamp" readonly="1"/>
                                <field name="status" readonly="1"/>
                            </group>
                            <group>
                                <field name="from_number" readonly="1"/>
                                <field name="from_name" readonly="1"/>
                                <field name="to_number" readonly="1"/>
                                <field name="to_name" readonly="1"/>
                                <field name="wa_message_id" readonly="1"/>
                            </group>
                        </group>
                        
                        <group string="Content">
                            <field name="message" readonly="1" widget="text"/>
                            <field name="attachment_id" readonly="1" invisible="not attachment_id"/>
                            <field name="media_url" readonly="1" invisible="not media_url"/>
                            <field name="media_type" readonly="1" invisible="not media_type"/>
                            <!-- <field name="location_lat" readonly="1" invisible="not location_lat"/> -->
                            <!-- <field name="location_lng" readonly="1" invisible="not location_lng"/> -->
                        </group>
                        
                        <group string="Related">
                            <field name="contact_id" readonly="1"/>
                            <field name="group_id" readonly="1"/>
                            <field name="lead_id" readonly="1"/>
                            <!-- <field name="opportunity_id" readonly="1"/> -->
                            <!-- <field name="order_id" readonly="1"/> -->
                        </group>
                        
                        <group string="Metadata">
                            <!-- <field name="quoted_message_id" readonly="1"/> -->
                            <field name="reply_to_message_id" readonly="1"/>
                            <!-- <field name="forwarded" readonly="1"/> -->
                            <field name="error_message" readonly="1" invisible="not error_message"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- WhatsApp Message Search View -->
        <record id="whatsapp_message_search" model="ir.ui.view">
            <field name="name">whatsapp.message.search</field>
            <field name="model">whatsapp.message</field>
            <field name="arch" type="xml">
                <search string="WhatsApp Messages">
                    <field name="message"/>
                    <field name="from_name"/>
                    <field name="to_name"/>
                    <field name="from_number"/>
                    <field name="to_number"/>
                    <field name="account_id"/>
                    <field name="contact_id"/>
                    <field name="group_id"/>
                    <separator/>
                    <filter string="Incoming" name="incoming" domain="[('direction', '=', 'incoming')]"/>
                    <filter string="Outgoing" name="outgoing" domain="[('direction', '=', 'outgoing')]"/>
                    <separator/>
                    <filter string="Text" name="text" domain="[('message_type', '=', 'text')]"/>
                    <filter string="Image" name="image" domain="[('message_type', '=', 'image')]"/>
                    <filter string="Video" name="video" domain="[('message_type', '=', 'video')]"/>
                    <filter string="Audio" name="audio" domain="[('message_type', '=', 'audio')]"/>
                    <filter string="Document" name="document" domain="[('message_type', '=', 'document')]"/>
                    <filter string="Location" name="location" domain="[('message_type', '=', 'location')]"/>
                    <separator/>
                    <filter string="Pending" name="pending" domain="[('status', '=', 'pending')]"/>
                    <filter string="Sent" name="sent" domain="[('status', '=', 'sent')]"/>
                    <filter string="Delivered" name="delivered" domain="[('status', '=', 'delivered')]"/>
                    <filter string="Read" name="read" domain="[('status', '=', 'read')]"/>
                    <filter string="Failed" name="failed" domain="[('status', '=', 'failed')]"/>
                    <separator/>
                    <filter string="Today" name="today" domain="[('timestamp', '&gt;=', datetime.datetime.now().strftime('%Y-%m-%d 00:00:00'))]"/>
                    <filter string="This Week" name="this_week" domain="[('timestamp', '&gt;=', (datetime.datetime.now() - datetime.timedelta(days=7)).strftime('%Y-%m-%d 00:00:00'))]"/>
                    <filter string="This Month" name="this_month" domain="[('timestamp', '&gt;=', (datetime.datetime.now() - datetime.timedelta(days=30)).strftime('%Y-%m-%d 00:00:00'))]"/>
                    <group expand="0" string="Group By">
                        <filter string="Account" name="group_account" domain="[]" context="{'group_by': 'account_id'}"/>
                        <filter string="Direction" name="group_direction" domain="[]" context="{'group_by': 'direction'}"/>
                        <filter string="Message Type" name="group_type" domain="[]" context="{'group_by': 'message_type'}"/>
                        <filter string="Status" name="group_status" domain="[]" context="{'group_by': 'status'}"/>
                        <filter string="Contact" name="group_contact" domain="[]" context="{'group_by': 'contact_id'}"/>
                        <filter string="Group" name="group_group" domain="[]" context="{'group_by': 'group_id'}"/>
                        <filter string="Date" name="group_date" domain="[]" context="{'group_by': 'timestamp:day'}"/>
                    </group>
                </search>
            </field>
        </record>
        
        <!-- WhatsApp Message Action -->
        <record id="whatsapp_message_action" model="ir.actions.act_window">
            <field name="name">WhatsApp Messages</field>
            <field name="res_model">whatsapp.message</field>
            <field name="view_mode">list,form</field>
            <field name="search_view_id" ref="whatsapp_message_search"/>
            <field name="context">{'search_default_today': 1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No messages yet
                </p>
                <p>
                    Messages will appear here once you start sending and receiving WhatsApp messages.
                </p>
            </field>
        </record>
        
    </data>
</odoo>